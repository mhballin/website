---
import { Image } from "astro:assets";
import type { Project, ProjectCategory } from "../data/projects";

interface Props {
  projects: Project[];
  category?: ProjectCategory;
}

const { projects, category } = Astro.props;
const isSingle = projects.length === 1;

const gridClass = isSingle
  ? "projects-grid grid grid-cols-1 gap-6 w-full"
  : "projects-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 w-full";

const cardClass = isSingle
  ? "group relative overflow-hidden rounded-lg cursor-pointer aspect-[16/10]"
  : "group relative overflow-hidden rounded-lg aspect-square cursor-pointer";
---

<div class={gridClass}>
  {
    projects.map((project) => {
      const idOrSlug = project.slug ?? project.id;
      const href = category 
        ? `/work/${category}/${idOrSlug}`
        : `/work/${project.category}/${idOrSlug}`;
      
      return (
        <a
          href={href}
          class={cardClass}
        >
          <Image
            src={project.heroImage}
            width={400}
            height={400}
            format="webp"
            alt={project.title}
            class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          />
          <div class="absolute inset-0 bg-black/0 group-hover:bg-black/30 transition-colors duration-300 flex items-end p-4">
            <div class="text-white opacity-0 group-hover:opacity-100 transition-opacity duration-300">
              <h3 class="font-bold text-lg">{project.title}</h3>
            </div>
          </div>
        </a>
      );
    })
  }
</div>

<style>
  .projects-grid {
    /* Responsive grid with cover-mode image cropping */
  }
</style>
