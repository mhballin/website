---
import { CONTACT_EMAIL } from "../config";
---

<div class="email-link-wrapper relative">
  <button
    class="email-link-button mx-3 group"
    title="Email"
    aria-label="Email options"
  >
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      style="fill: currentColor;"
      class="group-hover:scale-110 transition-transform"
    >
      <path d="M20 4H4c-1.103 0-2 .897-2 2v12c0 1.103.897 2 2 2h16c1.103 0 2-.897 2-2V6c0-1.103-.897-2-2-2zm0 2v.511l-8 6.223-8-6.222V6h16zM4 18V9.044l7.386 5.745a.994.994 0 0 0 1.228 0L20 9.044 20.002 18H4z" />
    </svg>
  </button>

  <div class="email-tooltip hidden absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-base-200 rounded-lg shadow-lg p-3 w-48 flex flex-col items-center gap-2 z-50">
    <span class="text-xs font-medium">{CONTACT_EMAIL}</span>
    <div class="flex gap-2">
      <button class="copy-btn btn btn-xs btn-ghost">Copy</button>
      <a href="mailto:{CONTACT_EMAIL}" class="btn btn-xs btn-ghost">Send</a>
    </div>
  </div>
</div>

<script>
  const wrapper = document.querySelector('.email-link-wrapper');
  const button = wrapper?.querySelector('.email-link-button');
  const tooltip = wrapper?.querySelector('.email-tooltip');
  const copyBtn = tooltip?.querySelector('.copy-btn');
  const email = '{CONTACT_EMAIL}';

  // Toggle tooltip on button click
  button?.addEventListener('click', () => {
    tooltip?.classList.toggle('hidden');
  });

  // Copy email
  copyBtn?.addEventListener('click', async (e) => {
    e.preventDefault();
    await navigator.clipboard.writeText(email);
    const originalText = copyBtn.textContent;
    copyBtn.textContent = 'âœ“ Copied!';
    setTimeout(() => {
      copyBtn.textContent = originalText;
    }, 2000);
  });

  // Close tooltip when clicking outside
  document.addEventListener('click', (e) => {
    if (!wrapper?.contains(e.target)) {
      tooltip?.classList.add('hidden');
    }
  });
</script>
